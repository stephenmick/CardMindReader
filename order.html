<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Mind Reader</title>
</head>

<body>
    <div class="heading">
        Card Mind Reader Orderer
    </div>
    <div class="instructions grey">
        Input five cards and I show how to order them for&nbsp;
        <a href="https://cardmindreader.com">CardMindReader</a>
    </div>
    <div id="cardForm">
        <div class="input" id="inputZero">
            <div class="info">&nbsp;</div>
            <div class="cardInput">
                <button id="0-2" onClick="select(event, 0, 2)">2</button>
                <button id="0-3" onClick="select(event, 0, 3)">3</button>
                <button id="0-4" onClick="select(event, 0, 4)">4</button>
                <button id="0-5" onClick="select(event, 0, 5)">5</button>
                <button id="0-6" onClick="select(event, 0, 6)">6</button>
                <button id="0-7" onClick="select(event, 0, 7)">7</button>
                <button id="0-8" onClick="select(event, 0, 8)">8</button>
                <button id="0-9" onClick="select(event, 0, 9)">9</button>
                <button id="0-10" onClick="select(event, 0, 10)">10</button>
                <button id="0-11" onClick="select(event, 0, 11)">J</button>
                <button id="0-12" onClick="select(event, 0, 12)">Q</button>
                <button id="0-13" onClick="select(event, 0, 13)">K</button>
                <button id="0-14" onClick="select(event, 0, 14)">A</button>
            </div>
            <div class="suitInput">
                <span>&nbsp;</span>
                <button id="0-20" onClick="selectSuit(event, 0, 20)">&clubs;</button>
                <button id="0-21" class="red" onClick="selectSuit(event, 0, 21)">&diams;</button>
                <button id="0-22" class="red" onClick="selectSuit(event, 0, 22)">&hearts;</button>
                <button id="0-23" onClick="selectSuit(event, 0, 23)">&spades;</button>
            </div>
        </div>

        <div class="input" id="inputOne">
            <div class="info">&nbsp;</div>
            <div class="cardInput">
                <button id="1-2" onClick="select(event, 1, 2)">2</button>
                <button id="1-3" onClick="select(event, 1, 3)">3</button>
                <button id="1-4" onClick="select(event, 1, 4)">4</button>
                <button id="1-5" onClick="select(event, 1, 5)">5</button>
                <button id="1-6" onClick="select(event, 1, 6)">6</button>
                <button id="1-7" onClick="select(event, 1, 7)">7</button>
                <button id="1-8" onClick="select(event, 1, 8)">8</button>
                <button id="1-9" onClick="select(event, 1, 9)">9</button>
                <button id="1-10" onClick="select(event, 1, 10)">10</button>
                <button id="1-11" onClick="select(event, 1, 11)">J</button>
                <button id="1-12" onClick="select(event, 1, 12)">Q</button>
                <button id="1-13" onClick="select(event, 1, 13)">K</button>
                <button id="1-14" onClick="select(event, 1, 14)">A</button>
            </div>
            <div class="suitInput">
                <span>&nbsp;</span>
                <button id="1-20" onClick="selectSuit(event, 1, 20)">&clubs;</button>
                <button id="1-21" class="red" onClick="selectSuit(event, 1, 21)">&diams;</button>
                <button id="1-22" class="red" onClick="selectSuit(event, 1, 22)">&hearts;</button>
                <button id="1-23" onClick="selectSuit(event, 1, 23)">&spades;</button>
            </div>
        </div>

        <div class="input" id="inputTwo">
            <div class="info">&nbsp;</div>
            <div class="cardInput">
                <button id="2-2" onClick="select(event, 2, 2)">2</button>
                <button id="2-3" onClick="select(event, 2, 3)">3</button>
                <button id="2-4" onClick="select(event, 2, 4)">4</button>
                <button id="2-5" onClick="select(event, 2, 5)">5</button>
                <button id="2-6" onClick="select(event, 2, 6)">6</button>
                <button id="2-7" onClick="select(event, 2, 7)">7</button>
                <button id="2-8" onClick="select(event, 2, 8)">8</button>
                <button id="2-9" onClick="select(event, 2, 9)">9</button>
                <button id="2-10" onClick="select(event, 2, 10)">10</button>
                <button id="2-11" onClick="select(event, 2, 11)">J</button>
                <button id="2-12" onClick="select(event, 2, 12)">Q</button>
                <button id="2-13" onClick="select(event, 2, 13)">K</button>
                <button id="2-14" onClick="select(event, 2, 14)">A</button>
            </div>
            <div class="suitInput">
                <span>&nbsp;</span>
                <button id="2-20" onClick="selectSuit(event, 2, 20)">&clubs;</button>
                <button id="2-21" class="red" onClick="selectSuit(event, 2, 21)">&diams;</button>
                <button id="2-22" class="red" onClick="selectSuit(event, 2, 22)">&hearts;</button>
                <button id="2-23" onClick="selectSuit(event, 2, 23)">&spades;</button>
            </div>
        </div>

        <div class="input" id="inputThree">
            <div class="info">&nbsp;</div>
            <div class="cardInput">
                <button id="3-2" onClick="select(event, 3, 2)">2</button>
                <button id="3-3" onClick="select(event, 3, 3)">3</button>
                <button id="3-4" onClick="select(event, 3, 4)">4</button>
                <button id="3-5" onClick="select(event, 3, 5)">5</button>
                <button id="3-6" onClick="select(event, 3, 6)">6</button>
                <button id="3-7" onClick="select(event, 3, 7)">7</button>
                <button id="3-8" onClick="select(event, 3, 8)">8</button>
                <button id="3-9" onClick="select(event, 3, 9)">9</button>
                <button id="3-10" onClick="select(event, 3, 10)">10</button>
                <button id="3-11" onClick="select(event, 3, 11)">J</button>
                <button id="3-12" onClick="select(event, 3, 12)">Q</button>
                <button id="3-13" onClick="select(event, 3, 13)">K</button>
                <button id="3-14" onClick="select(event, 3, 14)">A</button>
            </div>
            <div class="suitInput">
                <span>&nbsp;</span>
                <button id="3-20" onClick="selectSuit(event, 3, 20)">&clubs;</button>
                <button id="3-21" class="red" onClick="selectSuit(event, 3, 21)">&diams;</button>
                <button id="3-22" class="red" onClick="selectSuit(event, 3, 22)">&hearts;</button>
                <button id="3-23" onClick="selectSuit(event, 3, 23)">&spades;</button>
            </div>
        </div>

        <div id="cardForm">
            <div class="input" id="inputFour">
                <div class="info">&nbsp;</div>
                <div class="cardInput">
                    <button id="4-2" onClick="select(event, 4, 2)">2</button>
                    <button id="4-3" onClick="select(event, 4, 3)">3</button>
                    <button id="4-4" onClick="select(event, 4, 4)">4</button>
                    <button id="4-5" onClick="select(event, 4, 5)">5</button>
                    <button id="4-6" onClick="select(event, 4, 6)">6</button>
                    <button id="4-7" onClick="select(event, 4, 7)">7</button>
                    <button id="4-8" onClick="select(event, 4, 8)">8</button>
                    <button id="4-9" onClick="select(event, 4, 9)">9</button>
                    <button id="4-10" onClick="select(event, 4, 10)">10</button>
                    <button id="4-11" onClick="select(event, 4, 11)">J</button>
                    <button id="4-12" onClick="select(event, 4, 12)">Q</button>
                    <button id="4-13" onClick="select(event, 4, 13)">K</button>
                    <button id="4-14" onClick="select(event, 4, 14)">A</button>
                </div>
                <div class="suitInput">
                    <span>&nbsp;</span>
                    <button id="4-20" onClick="selectSuit(event, 4, 20)">&clubs;</button>
                    <button id="4-21" class="red" onClick="selectSuit(event, 4, 21)">&diams;</button>
                    <button id="4-22" class="red" onClick="selectSuit(event, 4, 22)">&hearts;</button>
                    <button id="4-23" onClick="selectSuit(event, 4, 23)">&spades;</button>
                </div>
            </div>

            <div class="instructions">
                Arrange the order of cards one of these ways ...
            </div>
            <div class="instructions">
                <span style="background-color:yellow">highlighted</span> cards remain in the same postion
            </div>
            <div class="btn">
                <input class="submit-button" type="submit" value="Arrange!" onClick="arrange()">
            </div>
        </div>
        <!-- <div class="answer">
        <h3 id="IntroText"></h3>
    </div> -->
        <div class="answer">
            <h2 id="solution"></h2>
        </div>
</body>

<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        document.getElementById('cardForm').addEventListener('submit', (event) => {
            event.preventDefault();
        })
    });

    function select(event, selectionNumber, cardValue) {
        event.stopPropagation();
        // clear prior selection
        clearSelection(selectionNumber, 2, 14);
        // add current selection
        highlightSelection(selectionNumber, cardValue);
    }

    function selectSuit(event, selectionNumber, suit) {
        event.stopPropagation();
        // clear prior selection
        clearSelection(selectionNumber, 20, 23);
        // add current selection
        highlightSelection(selectionNumber, suit);
    }


    // helper function to wipe the CSS from the card selection
    function clearSelection(selection, begin, end) {
        for (i = begin; i <= end; i++) {
            let element = selection + "-" + i.toString();
            console.log(element);
            document.getElementById(element).classList.remove("selected");
        }
    }

    // helper function to highlight selected buttons
    function highlightSelection(numberSelect, valueSelect) {
        const selectString = numberSelect + "-" + valueSelect;
        const element = document.getElementById(selectString);
        element.classList.add("selected");
    }

    // helper function to find the card value, input is 0, 1, 2, or 3
    function getCard(card) {
        let returnValue = 0;
        for (i = 2; i <= 14; i++) {
            if (document.getElementById(card + "-" + i).classList.contains("selected")) {
                returnValue = i;
                console.log("card " + card + " value: " + returnValue);
            }
        }
        return returnValue;
    }

    // helper function to find the card value, input is 0, 1, 2, or 3
    function getSuit(card) {
        let returnSuit = -1;
        for (i = 20; i <= 23; i++) {
            if (document.getElementById(card + "-" + i).classList.contains("selected")) {
                returnSuit = i % 10;
                console.log("card " + card + " suit: " + returnSuit)
            }
        }
        return returnSuit;
    }

    // helper function to convert suit number to the corresponding string
    function suitNumberToString(suitNumber) {
        let returnSuitString = "clubs";
        if (suitNumber === 1) {
            returnSuitString = "diamonds";
        }
        if (suitNumber === 2) {
            returnSuitString = "hearts";
        }
        if (suitNumber === 3) {
            returnSuitString = "spades";
        }
        return returnSuitString;
    }

    // main function to calculate the card arrangements
    function arrange() {
        const firstCardNumber = getCard(0);
        const firstCardSuit = getSuit(0);
        const secondCardNumber = getCard(1);
        const secondCardSuit = getSuit(1);
        const thirdCardNumber = getCard(2);
        const thirdCardSuit = getSuit(2);
        const fourthCardNumber = getCard(3);
        const fourthCardSuit = getSuit(3);
        const fifthCardNumber = getCard(4);
        const fifthCardSuit = getSuit(4);

        const cardArray = [firstCardNumber, secondCardNumber, thirdCardNumber, fourthCardNumber, fifthCardNumber];
        const suitArray = [firstCardSuit, secondCardSuit, thirdCardSuit, fourthCardSuit, fifthCardSuit];

        let abortFunction = false;

        // check that five card numbers and five suits are selected
        for (i = 0; i < 5; i++) {
            if (cardArray[i] < 2 || suitArray[i] === -1) {
                window.alert("Please select four cards and suits")
                i = 4;
                abortFunction = true;
            }
        }

        // only proceed if five cards are selected
        if (abortFunction) {
            return;
        }

        // the calculated fifth card suit is the same as the first card
        const first = cardValue(firstCardNumber, firstCardSuit);
        const second = cardValue(secondCardNumber, secondCardSuit);
        const third = cardValue(thirdCardNumber, thirdCardSuit);
        const fourth = cardValue(fourthCardNumber, fourthCardSuit);
        const fifth = cardValue(fifthCardNumber, fifthCardSuit);

        const valueArray = [first, second, third, fourth, fifth]

        // check that five different cards are selected
        for (i = 0; i < 4; i++) {
            for (j = i + 1; j < 5; j++) {
                if (valueArray[i] === valueArray[j]) {
                    window.alert("Please select four different cards");
                    abortFunction = true;
                }
            }
        }

        // only proceed if all cards are different
        if (abortFunction) {
            return;
        }

        // initialize the solution display
        solutionText = "";

        // initialize the card order
        let cardA = -1;
        let cardB = -1;
        let cardC = -1;
        let cardD = -1;
        let cardHidden = -1;

        // the distance between cardA and cardHidden will eventually be calculated as 1, 2, 3, 4, 5 or 6
        let distance = 0;

        // initialize answer index, which will eventually be 0, 1, 2 or 3 depending on the number of answers
        let answerIndex = -1;   
        
        // initialize the array for storing from one to four answer results
        let result = [
            {
                cardA: -1,
                cardB: -1,
                cardC: -1,
                cardD: -1,
                cardHidden: -1,
                distance: 0
            },
            {
                cardA: -1,
                cardB: -1,
                cardC: -1,
                cardD: -1,
                cardHidden: -1,
                distance: 0
            },
            {
                cardA: -1,
                cardB: -1,
                cardC: -1,
                cardD: -1,
                cardHidden: -1,
                distance: 0
            },
            {
                cardA: -1,
                cardB: -1,
                cardC: -1,
                cardD: -1,
                cardHidden: -1,
                distance: 0
            }
        ]

        // first find two cards that have the same suit
        for (i = 0; i < 4; i++) {
            for (j = i + 1; j < 5; j++) {
                if (suitArray[i] === suitArray[j]) {
                    // figure out which card is cardHidden card and which is cardA
                    let iNumber = cardArray[i];
                    let jNumber = cardArray[j];
                    // case when iNumber > jNumber and distance away is 6 or less
                    if (iNumber > jNumber && (iNumber - jNumber <= 6)) {
                        cardHidden = i;
                        cardA = j;
                        distance = iNumber - jNumber;
                    }
                    // case when jNumber > iNumber and distance away is 6 or less
                    else if (jNumber > iNumber && (jNumber - iNumber <= 6)) {
                        cardA = i;
                        cardHidden = j;
                        distance = jNumber - iNumber;
                    }
                    // otherwise it is a case that overlaps from A to 2
                    else {
                        // check whether the larger number is cardA and the smaller cardHidden
                        if (iNumber > jNumber) {
                            cardA = i;
                            cardHidden = j;
                            distance = jNumber - iNumber + 13;
                        }
                        else {
                            cardHidden = i;
                            cardA = j;
                            distance = iNumber - jNumber + 13;
                        }
                    }
                    answerIndex += 1;
                    // add the found cards to the result array
                    result[answerIndex].cardA = cardA;
                    result[answerIndex].cardHidden = cardHidden;
                    result[answerIndex].distance = distance;

                    console.log("cardA: " + cardArray[cardA] + " of " + suitArray[cardA]);
                    console.log("cardHidden: " + cardArray[cardHidden] + " of " + suitArray[cardHidden]);
                    // exit this part of the for loop
                    j = 4;
                }
            }
        }

        // iterate through the possible answers, there will be 1, 2, 3, or 4 answers
        for (h = 0; h <= answerIndex; h++) {

            let b = -1;
            let c = -1;
            let d = -1;

            // find the other 3 cards in the 5 card array
            for (i = 0; i < 5; i++) {
                if (i !== result[h].cardA && i !== result[h].cardHidden) {
                    if (b < 0) {
                        b = i;
                    }
                    else if (c < 0) {
                        c = i;
                    }
                    else {
                        d = i;
                    }
                }
            }
            console.log("****** cardA=" + result[h].cardA + " b=" + b + " c=" + c + " d=" + d + " cardHidden=" + result[h].cardHidden);

            // order by size, there are six different possibilities
            let small = -1;
            let middle = -1;
            let large = -1;
            if (valueArray[b] > valueArray[c] && valueArray[c] > valueArray[d]) {
                small = d;
                middle = c;
                large = b;
            }
            else if (valueArray[b] > valueArray[d] && valueArray[d] > valueArray[c]) {
                small = c;
                middle = d;
                large = b;
            }
            else if (valueArray[c] > valueArray[b] && valueArray[b] > valueArray[d]) {
                small = d;
                middle = b;
                large = c;
            }
            else if (valueArray[c] > valueArray[d] && valueArray[d] > valueArray[b]) {
                small = b;
                middle = d;
                large = c;
            }
            else if (valueArray[d] > valueArray[b] && valueArray[b] > valueArray[c]) {
                small = c;
                middle = b;
                large = d;
            }
            else {
                small = b;
                middle = c;
                large = d;
            }
            console.log("small = " + small + " middle = " + middle + " large = " + large + " distance = " + result[h].distance);

            // find the correct order of cardB cardC and cardD based on distance from cardA to cardHidden
            switch (result[h].distance) {
                case 1:
                    cardB = small;
                    cardC = middle;
                    cardD = large;
                    break;
                case 2:
                    cardB = small;
                    cardC = large;
                    cardD = middle;
                    break;
                case 3:
                    cardB = middle;
                    cardC = small;
                    cardD = large;
                    break;
                case 4:
                    cardB = middle;
                    cardC = large;
                    cardD = small;
                    break;
                case 5:
                    cardB = large;
                    cardC = small;
                    cardD = middle;
                    break;
                case 6:
                    cardB = large;
                    cardC = middle;
                    cardD = small;
                    break;
            }

            result[h].cardB = cardB;
            result[h].cardC = cardC;
            result[h].cardD = cardD;

            console.log("first card: " + cardDisplay(cardArray[result[h].cardA]) + " of " + suitDisplay(suitArray[result[h].cardA]));
            console.log("second card: " + cardDisplay(cardArray[result[h].cardB]) + " of " + suitDisplay(suitArray[result[h].cardB]));
            console.log("third card: " + cardDisplay(cardArray[result[h].cardC]) + " of " + suitDisplay(suitArray[result[h].cardC]));
            console.log("fourth card: " + cardDisplay(cardArray[result[h].cardD]) + " of " + suitDisplay(suitArray[result[h].cardD]));
            console.log("hidden card: " + cardDisplay(cardArray[result[h].cardHidden]) + " of " + suitDisplay(suitArray[result[h].cardHidden]));

            // display answer
            solutionArray = [result[h].cardA, result[h].cardB, result[h].cardC, result[h].cardD, result[h].cardHidden];
            solutionHeading = ["1st Card", "2nd Card", "3rd Card", "4th Card", "Hidden Card"];
            solution = document.getElementById("solution");

            for (i = 0; i < 5; i++) {
                solutionText += solutionHeading[i] + ": ";
                // use yellow highlight if the card is already in the proper position
                let isHighlight = false;   
                if (valueArray[i] === cardValue(cardArray[solutionArray[i]],suitArray[solutionArray[i]])){
                    isHighlight = true;
                }
                
                // use red text for cards that have a suit of hearts or diamonds
                if (suitArray[solutionArray[i]] === 1 || suitArray[solutionArray[i]] === 2) {
                    if (isHighlight) {
                        solutionText += '<span style="color:red;background-color:yellow">';
                    }
                    else {
                        solutionText += '<span style="color:red;background-color:lightskyblue">';
                    }
                }
                else {
                    if (isHighlight){
                        solutionText += '<span style="color:black;background-color:yellow">';
                    }
                    else {
                        solutionText += '<span style="color:black;background-color:lightskyblue">';
                    }
                }
                solutionText += cardDisplay(cardArray[solutionArray[i]]) + " of " + suitDisplay(suitArray[solutionArray[i]]) + '</span>' + "<br>";
            }
            solutionText += "----------------------" + "<br>";
        }

        solution.innerHTML = solutionText;

    }

    function suitDisplay(suitNumber) {
        let suit = '';
        switch (suitNumber) {
            case 0:
                suit = '&clubs;';
                break;
            case 1:
                suit = "&diams;"
                break;
            case 2:
                suit = '&hearts;'
                break;
            case 3:
                suit = '&spades;'
                break;
        }
        return suit;
    }


    // helper function to set the display for a card
    function cardDisplay(cardNumber) {
        let card = "1";
        switch (cardNumber) {
            case 2:
                card = "2";
                break;
            case 3:
                card = "3";
                break;
            case 4:
                card = "4";
                break;
            case 5:
                card = "5";
                break;
            case 6:
                card = "6";
                break;
            case 7:
                card = "7";
                break;
            case 8:
                card = "8";
                break;
            case 9:
                card = "9";
                break;
            case 10:
                card = "10";
                break;
            case 11:
                card = "J";
                break;
            case 12:
                card = "Q";
                break;
            case 13:
                card = "K";
                break;
            case 14:
                card = "A";
                break;
            // case 15:
            //     fifthCard = "2";
            //     break;
            // case 16:
            //     fifthCard = "3";
            //     break;
            // case 17:
            //     fifthCard = "4";
            //     break;
            // case 18:
            //     fifthCard = "5";
            //     break;
            // case 19:
            //     fifthCard = "6";
            //     break;
            // case 20:
            //     fifthCard = "7";
            //     break;
        }
        return card;
    }


    // returns 1, 2, 3, 4, 5, or 6 based on the order of the given cards
    function getDistance(alpha, beta, gamma) {
        // cases when alpha is smallest
        if (alpha < beta && alpha < gamma) {
            if (beta < gamma) {
                return 1;
            }
            else return 2;
        }
        // cases when alpha is biggest
        if (alpha > beta && alpha > gamma) {
            if (beta < gamma) {
                return 5;
            }
            else return 6;
        }
        // other two cases when alpha is the middle size
        if (beta < gamma) {
            return 3;
        }
        // otherwise it's the final case
        return 4;
    }

    function cardValue(number, suit) {
        let returnCardValue = number * 10 + suit;
        return returnCardValue;
    }
</script>

<style>
    a {
        color: grey;
    }

    body {
        font-family: Arial, Helvetica, sans-serif;
        /* background-image: linear-gradient(rgb(130, 255, 255), white); */
        /* background-repeat: no-repeat; */
        background-color: lightskyblue;
    }

    button {
        margin: 1px;
        border-radius: 4px;
    }

    h2 {
        color: black;
    }

    h5 {
        color: black;
    }

    /* default for mobile view */
    form {
        display: flex;
        flex-direction: column;
        margin-left: 5%;
        width: 90%;
    }

    /* for tablet */
    @media only screen and (min-width: 600px) {
        form {
            width: 70%;
            margin-left: 15%;
        }
    }


    /* for desktop */
    @media only screen and (min-width: 768px) {
        form {
            width: 50%;
            margin-left: 25%;
        }

        @media (hover:hover) {
            button:hover {
                box-shadow: 0px 0px 3px 3px grey;
            }

            .submit-button:hover {
                box-shadow: 0px 0px 3px 3px grey;
            }
        }
    }

    .input {
        display: grid;
        grid-template-columns: 1fr 1fr 4fr 4fr 1fr;
        grid-template-rows: auto;
        grid-template-areas: ". info left right .";
        align-items: center;
        border-top-left-radius: 20px;
        border-bottom-left-radius: 20px;
        padding: 5px;
        border: 5px;
        margin: 5px;
        color: black;
    }

    .heading {
        display: flex;
        justify-content: center;
        height: 30px;
        font-size: 30px;
        color: blue;
    }

    .instructions {
        display: flex;
        justify-content: center;
        height: 20px;
        margin: 15px;
    }

    #inputZero,
    #inputOne,
    #inputTwo,
    #inputThree,
    #inputFour {
        background-color: rgb(190, 225, 255);
    }

    .row {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        width: 100%;
    }

    .column {
        display: flex;
        flex-direction: column;
        flex-basis: 100%;
        flex: 1;
    }

    .info {
        grid-area: info;
    }

    .cardInput {
        display: inline-flex;
        justify-self: center;
        grid-area: left;
        flex-wrap: wrap;
    }

    .suitInput {
        display: inline-flex;
        justify-self: center;
        grid-area: right;
    }

    .btn {
        display: flex;
        justify-content: center;
    }

    .answer {
        display: flex;
        justify-content: center;
    }

    .red {
        color: red;
    }

    .grey {
        color: grey;
    }

    .submit-button {
        background-color: rgb(175, 175, 255);
        border-radius: 4px;
        height: 30px;
    }

    .selected {
        background-color: yellow;
    }
</style>

</html>